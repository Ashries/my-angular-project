<div class="countries-container">
  <h2>Maailman maat ja liput</h2>
  
  <!-- Status Info -->
  <div class="status-info" *ngIf="!isLoading && !error">
    <p><strong>PÃ¤ivÃ¤mÃ¤Ã¤rÃ¤:</strong> {{ getFormattedDate() }}</p>
    <p><strong>Data lÃ¤hde:</strong> REST Countries API</p>
    <p><strong>LÃ¶ytyi:</strong> {{ filteredCountries.length }} maata</p>
  </div>

  <!-- Search and Filters -->
  <mat-card class="filters-card">
    <mat-card-content>
      <!-- Search -->
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Hae maita</mat-label>
        <input 
          matInput 
          [(ngModel)]="searchTerm" 
          (input)="onSearch()"
          placeholder="Kirjoita maan nimi (esim. Suomi, Ruotsi)">
      </mat-form-field>

      <!-- Region Filter -->
      <div class="filter-row">
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Alue</mat-label>
          <mat-select [(value)]="selectedRegion" (selectionChange)="onRegionChange()">
            <mat-option *ngFor="let region of regions" [value]="region">
              {{ region }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Sort Filter -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>JÃ¤rjestÃ¤</mat-label>
          <mat-select [(value)]="selectedSort" (selectionChange)="onSortChange()">
            <mat-option *ngFor="let option of sortOptions" [value]="option">
              {{ option }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button mat-raised-button color="primary" (click)="loadEuropeanCountries()" [disabled]="isLoading">
          NÃ¤ytÃ¤ Euroopan maat
        </button>
        <button mat-raised-button color="accent" (click)="loadFinnishSpeakingCountries()" [disabled]="isLoading">
          Suomenkieliset maat
        </button>
        <button mat-button (click)="resetFilters()" [disabled]="isLoading">
          TyhjennÃ¤ suodattimet
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Ladataan maita...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-state">
    <mat-card>
      <mat-card-content>
        <p class="error-message">{{ error }}</p>
        <button mat-raised-button color="warn" (click)="loadCountries()">
          YritÃ¤ uudelleen
        </button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Countries List -->
  <div *ngIf="!isLoading && !error">
    <!-- No Results -->
    <div *ngIf="filteredCountries.length === 0" class="no-results">
      <mat-card>
        <mat-card-content>
          <p>Ei maita lÃ¶ytynyt hakusanalla "{{ searchTerm }}". Kokeile toista hakusanaa.</p>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Countries Grid -->
    <div class="countries-grid" *ngIf="filteredCountries.length > 0">
      <mat-card *ngFor="let country of filteredCountries" class="country-card">
        <mat-card-header>
          <img mat-card-avatar [src]="country.flags.png" [alt]="country.flags.alt || country.name.common" class="country-flag">
          <mat-card-title>{{ country.name.common }}</mat-card-title>
          <mat-card-subtitle>{{ country.name.official }}</mat-card-subtitle>
        </mat-card-header>
        
        <img mat-card-image [src]="country.flags.png" [alt]="country.flags.alt || 'Flag of ' + country.name.common" class="flag-image">
        
        <mat-card-content>
          <p><strong>ğŸ“ PÃ¤Ã¤kaupunki:</strong> {{ country.capital?.[0] || 'Ei pÃ¤Ã¤kaupunkia' }}</p>
          <p><strong>ğŸŒ Alue:</strong> {{ country.region }} <span *ngIf="country.subregion">({{ country.subregion }})</span></p>
          <p><strong>ğŸ‘¥ VÃ¤kiluku:</strong> {{ formatPopulation(country.population) }}</p>
          <p><strong>ğŸ—£ï¸ Kielet:</strong> {{ getLanguages(country.languages) }}</p>
          <p><strong>ğŸ’° Valuutat:</strong> {{ getCurrencies(country.currencies) }}</p>
          <p><strong>ğŸ“ Pinta-ala:</strong> {{ formatArea(country.area) }}</p>
          <p><strong>ğŸ›ï¸ ItsenÃ¤inen:</strong> {{ country.independent ? 'KyllÃ¤' : 'Ei' }}</p>
          <p><strong>ğŸ‡ºğŸ‡³ YK jÃ¤sen:</strong> {{ country.unMember ? 'KyllÃ¤' : 'Ei' }}</p>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>