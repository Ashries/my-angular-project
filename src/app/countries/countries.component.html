<div class="countries-container">
  <h1>ğŸŒ Maailman maat ja liput</h1>
  
  <!-- Status Info -->
  <div class="status-info" *ngIf="!isLoading && !error">
    <p><strong>Maat ladattu:</strong> {{ countries.length }} ({{ (countries | countryFilter:searchTerm).length }} nÃ¤ytetÃ¤Ã¤n)</p>
    <p><strong>Data lÃ¤hde:</strong> REST Countries API</p>
  </div>

  <!-- Search Box -->
  <div class="search-section">
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>ğŸ” Hae maita</mat-label>
      <input 
        matInput 
        [(ngModel)]="searchTerm"
        placeholder="Hae maan nimellÃ¤, pÃ¤Ã¤kaupungilla, alueella tai kielellÃ¤">
      <mat-hint>Kirjoita hakusana (esim. Suomi, Helsinki, Eurooppa, ruotsi)</mat-hint>
    </mat-form-field>
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button mat-raised-button color="primary" (click)="loadEuropeanCountries()" [disabled]="isLoading">
      ğŸ‡ªğŸ‡º NÃ¤ytÃ¤ Euroopan maat
    </button>
    <button mat-raised-button color="accent" (click)="loadFinnishSpeakingCountries()" [disabled]="isLoading">
      ğŸ‡«ğŸ‡® Suomenkieliset maat
    </button>
    <button mat-button (click)="resetFilters()">
      ğŸ—‘ï¸ TyhjennÃ¤ haku
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Ladataan maita...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-state">
    <mat-card>
      <mat-card-content>
        <p class="error-message">{{ error }}</p>
        <button mat-raised-button color="warn" (click)="loadCountries()">
          ğŸ”„ YritÃ¤ uudelleen
        </button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Countries List with Pipe Filtering -->
  <div *ngIf="!isLoading && !error">
    
    <!-- No Results -->
    <div *ngIf="(countries | countryFilter:searchTerm).length === 0" class="no-results">
      <mat-card>
        <mat-card-content>
          <p>Ei maita lÃ¶ytynyt hakusanalla "{{ searchTerm }}"</p>
          <p style="color: #666;">Kokeile hakusanoja: Suomi, Ruotsi, Helsinki, Eurooppa</p>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Countries Grid - USING THE PIPE HERE -->
    <div class="countries-grid">
      <mat-card *ngFor="let country of countries | countryFilter:searchTerm" class="country-card">
        
        <!-- Flag -->
        <div class="card-header" *ngIf="country.flags?.png">
          <img [src]="country.flags.png" 
               [alt]="country.flags.alt || country.name.common + ' lippu'"
               class="country-flag-large">
        </div>
        
        <mat-card-header>
          <mat-card-title>{{ country.name.common }}</mat-card-title>
          <mat-card-subtitle>{{ country.name.official }}</mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <div class="country-details">
            <p><strong>ğŸ“ PÃ¤Ã¤kaupunki:</strong> {{ getCapital(country.capital) }}</p>
            <p><strong>ğŸŒ Alue:</strong> {{ country.region }}</p>
            <p><strong>ğŸ‘¥ VÃ¤kiluku:</strong> {{ formatPopulation(country.population) }}</p>
            <p><strong>ğŸ—£ï¸ Kielet:</strong> {{ getLanguages(country.languages) }}</p>
          </div>
        </mat-card-content>
        
        <mat-card-actions>
          <button mat-button color="primary">LisÃ¤tiedot</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>